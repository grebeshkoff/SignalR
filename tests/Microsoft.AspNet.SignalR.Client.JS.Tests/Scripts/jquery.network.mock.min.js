(function(n){var i=function(t){var i=Array.prototype.slice.call(arguments);i.splice(0,1),n.each([n.network.ajax,n.network.eventsource,n.network.mask,n.network.websocket],function(){this[t].apply(this,i)})},r={disconnect:function(n){i("disconnect",n)},connect:function(){i("connect")}};n.network=r})($,window),function(n){var e=n.ajax,f=n.network,i={},o=0,r=!1,u=function(n,t){r=!0,n.Request.abort(),r=!1,t||n.Settings.error(n,"error")};n.ajax=function(n,t){var s,c,h,f=o++;return t||(t=n),c=t.success,h=t.error,t.success=function(){r===!1&&(c&&c.apply(this,arguments),delete i[f])},t.error=function(){r===!1&&(h&&h.apply(this,arguments),delete i[f])},s=e.apply(this,[n,t]),i[f]={Request:s,Settings:t},r&&setTimeout(function(){u(i[f],!1)},0),s},f.ajax={disconnect:function(n){var r,t;for(r in i)t=i[r],u(t,n)},connect:function(){r=!1}}}($,window),function(n,t){var f=!!t.WebSocket,o=f?WebSocket:{},s=n.network,r={},h=0,i=!1,u=function(n){i=!0,n.close(),i=!1;n.onclose({})};if(f){function e(n,t){var e,f=this,s=h++;f.onmessage,f.onclose,f.onopen,f.close=function(){return e.close()},f.send=function(){if(i)setTimeout(function(){u(r[s])},0);else return e.send.apply(e,arguments)},r[s]=f,setTimeout(function(){e=new o(n,t),e.onopen=function(){if(!i)return f.onopen.apply(f,arguments)},e.onmessage=function(){if(!i)return f.onmessage.apply(f,arguments)},e.onclose=function(){if(!i)return f.onclose.apply(f,arguments);delete r[s]},r[s]=f},0)}WebSocket=e}s.websocket={disconnect:function(n){var f,t;if(n)i=!0;else for(f in r)t=r[f],u(t)},connect:function(){i=!1}}}($,window),function(n){var u=n.network,r={},f=0,i=!1;u.mask={create:function(n,t,u,e){var s=n[t],o=n[u],h=f++;if(!s||!o)throw new Error("maskBase must have an onErrorProperty AND an onMessageProperty property");n[t]=function(){if(!i)return s.apply(this,arguments);e&&(n[t]=s,n[u]=o,delete r[h])},n[u]=function(){if(!i)return o.apply(this,arguments)},r[h]={onError:n[t],onMessage:n[u]}},subscribe:function(n,t,r){var u=n[t];return n[t]=function(){if(i)r&&r();else return u.apply(this,arguments)},{unsubscribe:function(){n[t]=u}}},disconnect:function(n){var u,t;if(n)i=!0;else for(u in r)t=r[u],t.onError()},connect:function(){i=!1}}}($,window),function(n,t){var f=!!t.EventSource,u=f?EventSource:{},o=n.network,r={},s=0,i=!1;if(f){function e(n,t){var o=new u(n,t),f=this,e=s++;f._events={},f.addEventListener=function(n,t){var r=function(){if(!i)return t.apply(this,arguments)};f._events[n]=r,o.addEventListener(n,r)},f.close=function(){return f._events=null,delete r[e],o.close()},r[e]=f}EventSource=e}o.eventsource={disconnect:function(n){var f,t;if(n)i=!0;else for(f in r)t=r[f],t._events.error.call(t,u.CLOSED),i=!0,t.close(),i=!1},connect:function(){i=!1}}}($,window)